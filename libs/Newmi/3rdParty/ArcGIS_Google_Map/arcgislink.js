!function(){function extractString_(e,t,r){var i=""===t?0:e.indexOf(t),a=""===r?e.length:e.indexOf(r,i+t.length);return e.substring(i+t.length,a)}function isString_(e){return e&&"string"==typeof e}function isArray_(e){return e&&e.splice}function isNumber_(e){return"number"==typeof e}function augmentObject_(e,t,r){if(e&&t){var i;for(i in e)!r&&i in t||(t[i]=e[i])}return t}function triggerEvent_(){G.event.trigger.apply(this,arguments)}function handleErr_(e,t){e&&t&&t.error&&e(t.error)}function formatTimeString_(e,t){var r="";return e&&(r+=e.getTime()-6e4*e.getTimezoneOffset()),t&&(r+=", "+(t.getTime()-6e4*t.getTimezoneOffset())),r}function setNodeOpacity_(e,t){if(t=Math.min(Math.max(t,0),1),e){var r=e.style;"undefined"!=typeof r.opacity&&(r.opacity=t),"undefined"!=typeof r.filters&&(r.filters.alpha.opacity=Math.floor(100*t)),"undefined"!=typeof r.filter&&(r.filter="alpha(opacity:"+Math.floor(100*t)+")")}}function getLayerDefsString_(e){var t="";for(var r in e)e.hasOwnProperty(r)&&(t.length>0&&(t+=";"),t+=r+":"+e[r]);return t}function getXmlHttp_(){if("undefined"==typeof XMLHttpRequest){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(r){}throw new Error("This browser does not support XMLHttpRequest.")}return new XMLHttpRequest}function getGeometryType_(e){var t=e;return isArray_(e)&&e.length>0&&(t=e[0]),t instanceof G.LatLng||t instanceof G.Marker?isArray_(e)&&e.length>1?GeometryType.MULTIPOINT:GeometryType.POINT:t instanceof G.Polyline?GeometryType.POLYLINE:t instanceof G.Polygon?GeometryType.POLYGON:t instanceof G.LatLngBounds?GeometryType.ENVELOPE:void 0!==t.x&&void 0!==t.y?GeometryType.POINT:t.points?GeometryType.MULTIPOINT:t.paths?GeometryType.POLYLINE:t.rings?GeometryType.POLYGON:null}function isOverlay_(e){var t=e;return isArray_(e)&&e.length>0&&(t=e[0]),isArray_(t)&&t.length>0&&(t=t[0]),t instanceof G.LatLng||t instanceof G.Marker||t instanceof G.Polyline||t instanceof G.Polygon||t instanceof G.LatLngBounds?!0:!1}function formatSRParam_(e){return e?isNumber_(e)?e:e.wkid?e.wkid:e.toJSON():null}function fromLatLngsToJSON_(e,t){for(var r,i=[],a=0,o=e.getLength();o>a;a++)r=e.getAt(a),i.push("["+r.lng()+","+r.lat()+"]");return t&&i.length>0&&i.push("["+e.getAt(0).lng()+","+e.getAt(0).lat()+"]"),i.join(",")}function fromOverlaysToJSON_(e){var t,r,i,a,o=getGeometryType_(e),n="{";switch(o){case GeometryType.POINT:t=isArray_(e)?e[0]:e,t instanceof G.Marker&&(t=t.getPosition()),n+="x:"+t.lng()+",y:"+t.lat();break;case GeometryType.MULTIPOINT:for(a=[],i=0;i<e.length;i++)t=e[i]instanceof G.Marker?e[i].getPosition():e[i],a.push("["+t.lng()+","+t.lat()+"]");n+="points: ["+a.join(",")+"]";break;case GeometryType.POLYLINE:for(a=[],r=isArray_(e)?e:[e],i=0;i<r.length;i++)a.push("["+fromLatLngsToJSON_(r[i].getPath())+"]");n+="paths:["+a.join(",")+"]";break;case GeometryType.POLYGON:a=[],t=isArray_(e)?e[0]:e;var s=t.getPaths();for(i=0;i<s.getLength();i++)a.push("["+fromLatLngsToJSON_(s.getAt(i),!0)+"]");n+="rings:["+a.join(",")+"]";break;case GeometryType.ENVELOPE:t=isArray_(e)?e[0]:e,n+="xmin:"+t.getSouthWest().lng()+",ymin:"+t.getSouthWest().lat()+",xmax:"+t.getNorthEast().lng()+",ymax:"+t.getNorthEast().lat()}return n+=", spatialReference:{wkid:4326}",n+="}"}function fromGeometryToJSON_(e){function t(e){for(var t=[],r=0,i=e.length;i>r;r++)t.push("["+e[r][0]+","+e[r][1]+"]");return"["+t.join(",")+"]"}function r(e){for(var r=[],i=0,a=e.length;a>i;i++)r.push(t(e[i]));return"["+r.join(",")+"]"}var i="{";return e.x?i+="x:"+e.x+",y:"+e.y:e.xmin?i+="xmin:"+e.xmin+",ymin:"+e.ymin+",xmax:"+e.xmax+",ymax:"+e.ymax:e.points?i+="points:"+t(e.points):e.paths?i+="paths:"+r(e.paths):e.rings&&(i+="rings:"+r(e.rings)),i+="}"}function fromEnvelopeToLatLngBounds_(e){var t=spatialReferences_[e.spatialReference.wkid||e.spatialReference.wkt];t=t||WGS84;var r=t.inverse([e.xmin,e.ymin]),i=t.inverse([e.xmax,e.ymax]);return new G.LatLngBounds(new G.LatLng(r[1],r[0]),new G.LatLng(i[1],i[0]))}function fromJSONToOverlays_(e,t){var r,i,a,o,n,s,l,h,p,_=null;if(t=t||{},e)if(_=[],e.x)r=new G.Marker(augmentObject_(t.markerOptions||t,{position:new G.LatLng(e.y,e.x)})),_.push(r);else{if(s=e.points||e.paths||e.rings,!s)return _;var c=[];for(i=0,a=s.length;a>i;i++)if(l=s[i],e.points)r=new G.Marker(augmentObject_(t.markerOptions||t,{position:new G.LatLng(l[1],l[0])})),_.push(r);else{for(p=[],o=0,n=l.length;n>o;o++)h=l[o],p.push(new G.LatLng(h[1],h[0]));e.paths?(r=new G.Polyline(augmentObject_(t.polylineOptions||t,{path:p})),_.push(r)):e.rings&&c.push(p)}e.rings&&(r=new G.Polygon(augmentObject_(t.polygonOptions||t,{paths:c})),_.push(r))}return _}function parseFeatures_(e,t){if(e){var r,i,a;for(r=0,i=e.length;i>r;r++)a=e[r],a.geometry&&(a.geometry=fromJSONToOverlays_(a.geometry,t))}}function formatRequestString_(e){var t;if("object"==typeof e){if(isArray_(e)){t=[];for(var r=0,i=e.length;i>r;r++)t.push(formatRequestString_(e[r]));return"["+t.join(",")+"]"}if(isOverlay_(e))return fromOverlaysToJSON_(e);if(e.toJSON)return e.toJSON();t="";for(var a in e)e.hasOwnProperty(a)&&(t.length>0&&(t+=", "),t+=a+":"+formatRequestString_(e[a]));return"{"+t+"}"}return e.toString()}function fromLatLngsToFeatureSet_(e){var t,r,i,a=[];for(t=0,r=e.length;r>t;t++)i=e[t],i instanceof G.Marker&&(i=i.getPosition()),a.push({geometry:{x:i.lng(),y:i.lat(),spatialReference:{wkid:4326}}});return{type:'"features"',features:a,doNotLocateOnRestrictedElements:!1}}function prepareGeometryParams_(e){var t={};if(!e)return null;var r,i,a=[];if(e.geometries&&e.geometries.length>0){r=e.geometries[0],i=isOverlay_(r);for(var o=0,n=e.geometries.length;n>o;o++)a.push(i?fromOverlaysToJSON_(e.geometries[o]):fromGeometryToJSON_(e.geometries[o]))}return e.geometryType||(e.geometryType=getGeometryType_(r)),i?t.inSR=WGS84.wkid:e.inSpatialReference&&(t.inSR=formatSRParam_(e.inSpatialReference)),e.outSpatialReference&&(t.outSR=formatSRParam_(e.outSpatialReference)),t.geometries='{geometryType:"'+e.geometryType+'", geometries:['+a.join(",")+"]}",t}function log_(e){if(window.console)window.console.log(e);else{var t=document.getElementById("_ags_log");t&&(t.innerHTML=t.innerHTML+e+"<br/>")}}function formatParams_(e){var t="";if(e){e.f=e.f||"json";for(var r in e)if(e.hasOwnProperty(r)&&null!==e[r]&&void 0!==e[r]){var i=formatRequestString_(e[r]);t+=(t.length>0?"&":"")+(r+"="+(escape?escape(i):encodeURIComponent(i)))}}return t}function callback_(e,t){for(var r=[],i=2,a=arguments.length;a>i;i++)r.push(arguments[i]);return function(){e.apply(t,r)}}function addCopyrightInfo_(e,t,r){t.hasLoaded()?e.push(t.copyrightText):G.event.addListenerOnce(t,"load",function(){setCopyrightInfo_(r)})}function setCopyrightInfo_(e){var t=null;if(e){var r=e.controls[G.ControlPosition.BOTTOM_RIGHT];if(r)for(var i=0,a=r.getLength();a>i;i++)if("agsCopyrights"===r.getAt(i).id){t=r.getAt(i);break}t||(t=document.createElement("div"),t.style.fontFamily="Arial,sans-serif",t.style.fontSize="10px",t.style.textAlign="right",t.id="agsCopyrights",e.controls[G.ControlPosition.BOTTOM_RIGHT].push(t),G.event.addListener(e,"maptypeid_changed",function(){setCopyrightInfo_(e)}));var o,n=e.agsOverlays,s=[];if(n)for(var i=0,a=n.getLength();a>i;i++)addCopyrightInfo_(s,n.getAt(i).mapService_,e);var l=e.overlayMapTypes;if(l)for(var i=0,a=l.getLength();a>i;i++)if(o=l.getAt(i),o instanceof MapType)for(var h=0,p=o.tileLayers_.length;p>h;h++)addCopyrightInfo_(s,o.tileLayers_[h].mapService_,e);if(o=e.mapTypes.get(e.getMapTypeId()),o instanceof MapType){for(var i=0,a=o.tileLayers_.length;a>i;i++)addCopyrightInfo_(s,o.tileLayers_[i].mapService_,e);t.style.color=o.negative?"#ffffff":"#000000"}t.innerHTML=s.join("<br/>")}}function getJSON_(url,params,callbackName,callbackFn){var sid="ags_jsonp_"+jsonpID_++ +"_"+Math.floor(1e6*Math.random()),script=null;params=params||{},params[callbackName||"callback"]="ags_jsonp."+sid;var query=formatParams_(params),head=document.getElementsByTagName("head")[0];if(!head)throw new Error("document must have header tag");var jsonpcallback=function(){window.ags_jsonp[sid]&&delete window.ags_jsonp[sid],script&&head.removeChild(script),script=null,callbackFn.apply(null,arguments),triggerEvent_(Util,"jsonpend",sid)};if(window.ags_jsonp[sid]=jsonpcallback,(query+url).length<2e3&&!Config.alwaysUseProxy)script=document.createElement("script"),script.src=url+(-1===url.indexOf("?")?"?":"&")+query,script.id=sid,head.appendChild(script);else{var loc=window.location,dom=loc.protocol+"//"+loc.hostname+(loc.port&&80!==loc.port?":"+loc.port+"/":""),useProxy=!0;if(-1!==url.toLowerCase().indexOf(dom.toLowerCase())&&(useProxy=!1),Config.alwaysUseProxy&&(useProxy=!0),useProxy&&!Config.proxyUrl)throw new Error("No proxyUrl property in Config is defined");var xmlhttp=getXmlHttp_();xmlhttp.onreadystatechange=function(){if(4===xmlhttp.readyState){if(200!==xmlhttp.status)throw new Error("Error code "+xmlhttp.status);eval(xmlhttp.responseText)}},xmlhttp.open("POST",useProxy?Config.proxyUrl+"?"+url:url,!0),xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xmlhttp.send(query)}return triggerEvent_(Util,"jsonpstart",sid),sid}function SpatialReference(e){e=e||{},this.wkid=e.wkid,this.wkt=e.wkt}function Geographic(e){e=e||{},SpatialReference.call(this,e)}function LambertConformalConic(e){e=e||{},SpatialReference.call(this,e);var t=e.inverse_flattening,r=e.standard_parallel_1*RAD_DEG,i=e.standard_parallel_2*RAD_DEG,a=e.latitude_of_origin*RAD_DEG;this.a_=e.semi_major/e.unit,this.lamda0_=e.central_meridian*RAD_DEG,this.FE_=e.false_easting,this.FN_=e.false_northing;var o=1/t,n=2*o-o*o;this.e_=Math.sqrt(n);var s=this.calc_m_(r,n),l=this.calc_m_(i,n),h=this.calc_t_(a,this.e_),p=this.calc_t_(r,this.e_),_=this.calc_t_(i,this.e_);this.n_=Math.log(s/l)/Math.log(p/_),this.F_=s/(this.n_*Math.pow(p,this.n_)),this.rho0_=this.calc_rho_(this.a_,this.F_,h,this.n_)}function TransverseMercator(e){e=e||{},SpatialReference.call(this,e),this.a_=e.semi_major/e.unit;var t=e.inverse_flattening;this.k0_=e.scale_factor;var r=e.latitude_of_origin*RAD_DEG;this.lamda0_=e.central_meridian*RAD_DEG,this.FE_=e.false_easting,this.FN_=e.false_northing;var i=1/t;this.es_=2*i-i*i,this.ep4_=this.es_*this.es_,this.ep6_=this.ep4_*this.es_,this.eas_=this.es_/(1-this.es_),this.M0_=this.calc_m_(r,this.a_,this.es_,this.ep4_,this.ep6_)}function SphereMercator(e){e=e||{},SpatialReference.call(this,e),this.a_=(e.semi_major||6378137)/(e.unit||1),this.lamda0_=(e.central_meridian||0)*RAD_DEG}function Albers(e){e=e||{},SpatialReference.call(this,e);var t=e.inverse_flattening,r=e.standard_parallel_1*RAD_DEG,i=e.standard_parallel_2*RAD_DEG,a=e.latitude_of_origin*RAD_DEG;this.a_=e.semi_major/e.unit,this.lamda0_=e.central_meridian*RAD_DEG,this.FE_=e.false_easting,this.FN_=e.false_northing;var o=1/t,n=2*o-o*o;this.e_=Math.sqrt(n);var s=this.calc_m_(r,n),l=this.calc_m_(i,n),h=this.calc_q_(r,this.e_),p=this.calc_q_(i,this.e_),_=this.calc_q_(a,this.e_);this.n_=(s*s-l*l)/(p-h),this.C_=s*s+this.n_*h,this.rho0_=this.calc_rho_(this.a_,this.C_,this.n_,_)}function Catalog(e){this.url=e;var t=this;getJSON_(e,{},"",function(e){augmentObject_(e,t),triggerEvent_(t,"load")})}function Layer(e){this.url=e,this.definition=null}function MapService(e,t){this.url=e,this.loaded_=!1;var r=e.split("/");if(this.name=r[r.length-2].replace(/_/g," "),t=t||{},t.delayLoad){var i=this;window.setTimeout(function(){i.loadServiceInfo()},1e3*t.delayLoad)}else this.loadServiceInfo()}function GeocodeService(e){this.url=e,this.loaded_=!1;var t=this;getJSON_(e,{},"",function(e){t.init_(e)})}function GeometryService(e){this.url=e,this.t="geocodeservice"}function GPService(e){this.url=e,this.loaded_=!1;var t=this;getJSON_(e,{},"",function(e){augmentObject_(e,t),t.loaded_=!0,triggerEvent_(t,"load")})}function GPTask(e){this.url=e,this.loaded_=!1;var t=this;getJSON_(e,{},"",function(e){augmentObject_(e,t),t.loaded_=!0,triggerEvent_(t,"load")})}function NetworkService(e){this.url=e,this.loaded_=!1;var t=this;getJSON_(e,{},"",function(e){augmentObject_(e,t),t.loaded_=!0,triggerEvent_(t,"load")})}function RouteTask(e){this.url=e}function Projection(e){if(this.lods_=e?e.lods:null,this.spatialReference_=e?spatialReferences_[e.spatialReference.wkid||e.spatialReference.wkt]:WEB_MERCATOR,!this.spatialReference_)throw new Error("unsupported Spatial Reference");if(this.resolution0_=e?e.lods[0].resolution:156543.033928,this.minZoom=Math.floor(Math.log(this.spatialReference_.getCircum()/this.resolution0_/256)/Math.LN2+.5),this.maxZoom=e?this.minZoom+this.lods_.length-1:20,G.Size&&(this.tileSize_=e?new G.Size(e.cols,e.rows):new G.Size(256,256)),this.scale_=Math.pow(2,this.minZoom)*this.resolution0_,this.originX_=e?e.origin.x:-20037508.342787,this.originY_=e?e.origin.y:20037508.342787,e)for(var t,r=0;r<e.lods.length-1;r++)if(t=e.lods[r].resolution/e.lods[r+1].resolution,t>2.001||1.999>t)throw new Error("This type of map cache is not supported in V3. \nScale ratio between zoom levels must be 2")}function TileLayer(e,t){if(t=t||{},t.opacity&&(this.opacity_=t.opacity,delete t.opacity),augmentObject_(t,this),this.mapService_=e instanceof MapService?e:new MapService(e),t.hosts){var r=extractString_(this.mapService_.url,"","://"),i=extractString_(this.mapService_.url,"://","/"),a=extractString_(this.mapService_.url,r+"://"+i,"");this.urlTemplate_=r+"://"+t.hosts+a,this.numOfHosts_=parseInt(extractString_(t.hosts,"[","]"),10)}if(this.name=t.name||this.mapService_.name,this.maxZoom=t.maxZoom||19,this.minZoom=t.minZoom||0,this.dynaZoom=t.dynaZoom||this.maxZoom,this.mapService_.loaded_)this.init_(t);else{var o=this;G.event.addListenerOnce(this.mapService_,"load",function(){o.init_(t)})}this.tiles_={},this.map_=t.map}function MapType(e,t){t=t||{};var r;t.opacity&&(this.opacity_=t.opacity,delete t.opacity),augmentObject_(t,this);var i=e;if(isString_(e))i=[new TileLayer(e,t)];else if(e instanceof MapService)i=[new TileLayer(e,t)];else if(e instanceof TileLayer)i=[e];else if(e.length>0&&isString_(e[0]))for(i=[],r=0;r<e.length;r++)i[r]=new TileLayer(e[r],t);if(this.tileLayers_=i,this.tiles_={},void 0!==t.maxZoom)this.maxZoom=t.maxZoom;else{var a=0;for(r=0;r<i.length;r++)a=Math.max(a,i[r].maxZoom);this.maxZoom=a}i[0].projection_?(this.tileSize=i[0].projection_.tileSize_,this.projection=i[0].projection_):this.tileSize=new G.Size(256,256),this.name||(this.name=i[0].name)}function MapOverlay(e,t){t=t||{},this.mapService_=e instanceof MapService?e:new MapService(e),this.minZoom=t.minZoom,this.maxZoom=t.maxZoom,this.opacity_=t.opacity||1,this.exportOptions_=t.exportOptions||{},this.drawing_=!1,this.needsNewRefresh_=!1,this.overlay_=null,this.div_=null,t.map&&this.setMap(t.map),this.map_=null,this.listeners_=[]}function ImageOverlay(e,t,r,i){this.bounds_=e,this.url_=t,this.map_=r,this.div_=null,this.op_=i,this.setMap(r)}function CopyrightControl(e){this.map_=e,setCopyrightInfo_(e)}var gmaps=gmaps||{},RAD_DEG=Math.PI/180,jsonpID_=0;window.ags_jsonp=window.ags_jsonp||{};var G=google.maps,WGS84,NAD83,WEB_MERCATOR,WEB_MERCATOR_AUX,Config={proxyUrl:null,alwaysUseProxy:!1},spatialReferences_={},Util={},GeometryType={POINT:"esriGeometryPoint",MULTIPOINT:"esriGeometryMultipoint",POLYLINE:"esriGeometryPolyline",POLYGON:"esriGeometryPolygon",ENVELOPE:"esriGeometryEnvelope"};Util.getJSON=function(e,t,r,i){getJSON_(e,t,r,i)},Util.addToMap=function(e,t){if(isArray_(t))for(var r,i=0,a=t.length;a>i;i++)r=t[i],isArray_(r)?Util.addToMap(e,r):isOverlay_(r)&&r.setMap(e)},Util.removeFromMap=function(e,t){Util.addToMap(null,e),t&&(e.length=0)},SpatialReference.prototype.forward=function(e){return e},SpatialReference.prototype.inverse=function(e){return e},SpatialReference.prototype.getCircum=function(){return 360},SpatialReference.prototype.toJSON=function(){return"{"+(this.wkid?" wkid:"+this.wkid:"wkt: '"+this.wkt+"'")+"}"},Geographic.prototype=new SpatialReference,LambertConformalConic.prototype=new SpatialReference,LambertConformalConic.prototype.calc_m_=function(e,t){var r=Math.sin(e);return Math.cos(e)/Math.sqrt(1-t*r*r)},LambertConformalConic.prototype.calc_t_=function(e,t){var r=t*Math.sin(e);return Math.tan(Math.PI/4-e/2)/Math.pow((1-r)/(1+r),t/2)},LambertConformalConic.prototype.calc_rho_=function(e,t,r,i){return e*t*Math.pow(r,i)},LambertConformalConic.prototype.calc_phi_=function(e,t,r){var i=t*Math.sin(r);return Math.PI/2-2*Math.atan(e*Math.pow((1-i)/(1+i),t/2))},LambertConformalConic.prototype.solve_phi_=function(e,t,r){for(var i=0,a=r,o=this.calc_phi_(e,t,a);Math.abs(o-a)>1e-9&&10>i;)i++,a=o,o=this.calc_phi_(e,t,a);return o},LambertConformalConic.prototype.forward=function(e){var t=e[1]*RAD_DEG,r=e[0]*RAD_DEG,i=this.calc_t_(t,this.e_),a=this.calc_rho_(this.a_,this.F_,i,this.n_),o=this.n_*(r-this.lamda0_),n=this.FE_+a*Math.sin(o),s=this.FN_+this.rho0_-a*Math.cos(o);return[n,s]},LambertConformalConic.prototype.inverse=function(e){var t=e[0]-this.FE_,r=e[1]-this.FN_,i=Math.atan(t/(this.rho0_-r)),a=(this.n_>0?1:-1)*Math.sqrt(t*t+(this.rho0_-r)*(this.rho0_-r)),o=Math.pow(a/(this.a_*this.F_),1/this.n_),n=Math.PI/2-2*Math.atan(o),s=this.solve_phi_(o,this.e_,n),l=i/this.n_+this.lamda0_;return[l/RAD_DEG,s/RAD_DEG]},LambertConformalConic.prototype.getCircum=function(){return 2*Math.PI*this.a_},TransverseMercator.prototype=new SpatialReference,TransverseMercator.prototype.calc_m_=function(e,t,r,i,a){return t*((1-r/4-3*i/64-5*a/256)*e-(3*r/8+3*i/32+45*a/1024)*Math.sin(2*e)+(15*i/256+45*a/1024)*Math.sin(4*e)-35*a/3072*Math.sin(6*e))},TransverseMercator.prototype.forward=function(e){var t=e[1]*RAD_DEG,r=e[0]*RAD_DEG,i=this.a_/Math.sqrt(1-this.es_*Math.pow(Math.sin(t),2)),a=Math.pow(Math.tan(t),2),o=this.eas_*Math.pow(Math.cos(t),2),n=(r-this.lamda0_)*Math.cos(t),s=this.calc_m_(t,this.a_,this.es_,this.ep4_,this.ep6_),l=this.FE_+this.k0_*i*(n+(1-a+o)*Math.pow(n,3)/6+(5-18*a+a*a+72*o-58*this.eas_)*Math.pow(n,5)/120),h=this.FN_+this.k0_*(s-this.M0_)+i*Math.tan(t)*(n*n/2+(5-a+9*o+4*o*o)*Math.pow(n,4)/120+(61-58*a+a*a+600*o-330*this.eas_)*Math.pow(n,6)/720);return[l,h]},TransverseMercator.prototype.inverse=function(e){var t=e[0],r=e[1],i=(1-Math.sqrt(1-this.es_))/(1+Math.sqrt(1-this.es_)),a=this.M0_+(r-this.FN_)/this.k0_,o=a/(this.a_*(1-this.es_/4-3*this.ep4_/64-5*this.ep6_/256)),n=o+(3*i/2-27*Math.pow(i,3)/32)*Math.sin(2*o)+(21*i*i/16-55*Math.pow(i,4)/32)*Math.sin(4*o)+151*Math.pow(i,3)/6*Math.sin(6*o)+1097*Math.pow(i,4)/512*Math.sin(8*o),s=this.eas_*Math.pow(Math.cos(n),2),l=Math.pow(Math.tan(n),2),h=this.a_/Math.sqrt(1-this.es_*Math.pow(Math.sin(n),2)),p=this.a_*(1-this.es_)/Math.pow(1-this.es_*Math.pow(Math.sin(n),2),1.5),_=(t-this.FE_)/(h*this.k0_),c=n-h*Math.tan(n)/p*(_*_/2-(5+3*l+10*s-4*s*s-9*this.eas_)*Math.pow(_,4)/24+(61+90*l+28*s+45*l*l-252*this.eas_-3*s*s)*Math.pow(_,6)/720),f=this.lamda0_+(_-(1+2*l+s)*Math.pow(_,3)/6+(5-2*s+28*l-3*s*s+8*this.eas_+24*l*l)*Math.pow(_,5)/120)/Math.cos(n);return[f/RAD_DEG,c/RAD_DEG]},TransverseMercator.prototype.getCircum=function(){return 2*Math.PI*this.a_},SphereMercator.prototype=new SpatialReference,SphereMercator.prototype.forward=function(e){var t=e[1]*RAD_DEG,r=e[0]*RAD_DEG,i=this.a_*(r-this.lamda0_),a=this.a_/2*Math.log((1+Math.sin(t))/(1-Math.sin(t)));return[i,a]},SphereMercator.prototype.inverse=function(e){var t=e[0],r=e[1],i=Math.PI/2-2*Math.atan(Math.exp(-r/this.a_)),a=t/this.a_+this.lamda0_;return[a/RAD_DEG,i/RAD_DEG]},SphereMercator.prototype.getCircum=function(){return 2*Math.PI*this.a_},Albers.prototype=new SpatialReference,Albers.prototype.calc_m_=function(e,t){var r=Math.sin(e);return Math.cos(e)/Math.sqrt(1-t*r*r)},Albers.prototype.calc_q_=function(e,t){var r=t*Math.sin(e);return(1-t*t)*(Math.sin(e)/(1-r*r)-1/(2*t)*Math.log((1-r)/(1+r)))},Albers.prototype.calc_rho_=function(e,t,r,i){return e*Math.sqrt(t-r*i)/r},Albers.prototype.calc_phi_=function(e,t,r){var i=t*Math.sin(r);return r+(1-i*i)*(1-i*i)/(2*Math.cos(r))*(e/(1-t*t)-Math.sin(r)/(1-i*i)+Math.log((1-i)/(1+i))/(2*t))},Albers.prototype.solve_phi_=function(e,t,r){for(var i=0,a=r,o=this.calc_phi_(e,t,a);Math.abs(o-a)>1e-8&&10>i;)i++,a=o,o=this.calc_phi_(e,t,a);return o},Albers.prototype.forward=function(e){var t=e[1]*RAD_DEG,r=e[0]*RAD_DEG,i=this.calc_q_(t,this.e_),a=this.calc_rho_(this.a_,this.C_,this.n_,i),o=this.n_*(r-this.lamda0_),n=this.FE_+a*Math.sin(o),s=this.FN_+this.rho0_-a*Math.cos(o);return[n,s]},Albers.prototype.inverse=function(e){var t=e[0]-this.FE_,r=e[1]-this.FN_,i=Math.sqrt(t*t+(this.rho0_-r)*(this.rho0_-r)),a=this.n_>0?1:-1,o=Math.atan(a*t/(a*this.rho0_-a*r)),n=(this.C_-i*i*this.n_*this.n_/(this.a_*this.a_))/this.n_,s=Math.asin(n/2),l=this.solve_phi_(n,this.e_,s),h=o/this.n_+this.lamda0_;return[h/RAD_DEG,l/RAD_DEG]},Albers.prototype.getCircum=function(){return 2*Math.PI*this.a_},Albers.prototype.getCircum=function(){return 2*Math.PI*this.a_},WGS84=new Geographic({wkid:4326}),NAD83=new Geographic({wkid:4269}),WEB_MERCATOR=new SphereMercator({wkid:102113,semi_major:6378137,central_meridian:0,unit:1}),WEB_MERCATOR_AUX=new SphereMercator({wkid:102100,semi_major:6378137,central_meridian:0,unit:1}),spatialReferences_={4326:WGS84,4269:NAD83,102113:WEB_MERCATOR,102100:WEB_MERCATOR_AUX},SpatialReference.WGS84=WGS84,SpatialReference.NAD83=NAD83,SpatialReference.WEB_MERCATOR=WEB_MERCATOR,SpatialReference.WEB_MERCATOR_AUX=WEB_MERCATOR_AUX,Util.registerSR=function(e,t){var r=spatialReferences_[""+e];if(r)return r;if(t instanceof SpatialReference)spatialReferences_[""+e]=t,r=t;else{var i=t||e,a={wkt:e};e===parseInt(e,10)&&(a={wkid:e});var o=extractString_(i,'PROJECTION["','"]'),n=extractString_(i,"SPHEROID[","]").split(",");switch(""!==o&&(a.unit=parseFloat(extractString_(extractString_(i,"PROJECTION",""),"UNIT[","]").split(",")[1]),a.semi_major=parseFloat(n[1]),a.inverse_flattening=parseFloat(n[2]),a.latitude_of_origin=parseFloat(extractString_(i,'"Latitude_Of_Origin",',"]")),a.central_meridian=parseFloat(extractString_(i,'"Central_Meridian",',"]")),a.false_easting=parseFloat(extractString_(i,'"False_Easting",',"]")),a.false_northing=parseFloat(extractString_(i,'"False_Northing",',"]"))),o){case"":r=new SpatialReference(a);break;case"Lambert_Conformal_Conic":a.standard_parallel_1=parseFloat(extractString_(i,'"Standard_Parallel_1",',"]")),a.standard_parallel_2=parseFloat(extractString_(i,'"Standard_Parallel_2",',"]")),r=new LambertConformalConic(a);break;case"Transverse_Mercator":a.scale_factor=parseFloat(extractString_(i,'"Scale_Factor",',"]")),r=new TransverseMercator(a);break;case"Albers":a.standard_parallel_1=parseFloat(extractString_(i,'"Standard_Parallel_1",',"]")),a.standard_parallel_2=parseFloat(extractString_(i,'"Standard_Parallel_2",',"]")),r=new Albers(a);break;default:throw new Error(o+"  not supported")}r&&(spatialReferences_[""+e]=r)}return r},Layer.prototype.load=function(){var e=this;this.loaded_||getJSON_(this.url,{},"",function(t){augmentObject_(t,e),e.loaded_=!0,triggerEvent_(e,"load")})},Layer.prototype.isInScale=function(e){return this.maxScale&&this.maxScale>e?!1:this.minScale&&this.minScale<e?!1:!0};var SpatialRelationship={INTERSECTS:"esriSpatialRelIntersects",CONTAINS:"esriSpatialRelContains",CROSSES:"esriSpatialRelCrosses",ENVELOPE_INTERSECTS:"esriSpatialRelEnvelopeIntersects",INDEX_INTERSECTS:"esriSpatialRelIndexIntersects",OVERLAPS:"esriSpatialRelOverlaps",TOUCHES:"esriSpatialRelTouches",WITHIN:"esriSpatialRelWithin"};Layer.prototype.query=function(e,t,r){if(e){var i=augmentObject_(e,{});e.geometry&&!isString_(e.geometry)&&(i.geometry=fromOverlaysToJSON_(e.geometry),i.geometryType=getGeometryType_(e.geometry),i.inSR=4326),e.spatialRelationship&&(i.spatialRel=e.spatialRelationship,delete i.spatialRelationship),e.outFields&&isArray_(e.outFields)&&(i.outFields=e.outFields.join(",")),e.objectIds&&(i.objectIds=e.objectIds.join(",")),e.time&&(i.time=formatTimeString_(e.time,e.endTime)),i.outSR=4326,i.returnGeometry=e.returnGeometry===!1?!1:!0,i.returnIdsOnly=e.returnIdsOnly===!0?!0:!1,delete i.overlayOptions,getJSON_(this.url+"/query",i,"",function(i){parseFeatures_(i.features,e.overlayOptions),t(i,i.error),handleErr_(r,i)})}},Layer.prototype.queryRelatedRecords=function(e,t,r){if(e){var i=augmentObject_(e,{});i.f=i.f||"json",i.outFields&&!isString_(i.outFields)&&(i.outFields=i.outFields.join(",")),i.returnGeometry=i.returnGeometry===!1?!1:!0,getJSON_(this.url+"/query",i,"",function(e){handleErr_(r,e),t(e)})}},MapService.prototype.loadServiceInfo=function(){var e=this;getJSON_(this.url,{},"",function(t){e.init_(t)})},MapService.prototype.init_=function(e){var t=this;if(e.error)throw new Error(e.error.message);augmentObject_(e,this),this.spatialReference=e.spatialReference.wkt?Util.registerSR(e.spatialReference.wkt):spatialReferences_[e.spatialReference.wkid],void 0!==e.tables?getJSON_(this.url+"/layers",{},"",function(e){t.initLayers_(e),getJSON_(t.url+"/legend",{},"",function(e){t.initLegend_(e),t.setLoaded_()})}):(t.initLayers_(e),t.setLoaded_())},MapService.prototype.setLoaded_=function(){this.loaded_=!0,triggerEvent_(this,"load")},MapService.prototype.initLayers_=function(e){var t=[],r=[];this.layers=t,e.tables&&(this.tables=r);var i,a,o,n;for(a=0,o=e.layers.length;o>a;a++)n=e.layers[a],i=new Layer(this.url+"/"+n.id),augmentObject_(n,i),i.visible=i.defaultVisibility,t.push(i);if(e.tables)for(a=0,o=e.tables.length;o>a;a++)n=e.tables[a],i=new Layer(this.url+"/"+n.id),augmentObject_(n,i),r.push(i);for(a=0,o=t.length;o>a;a++)if(i=t[a],i.subLayerIds){i.subLayers=[];for(var s=0,l=i.subLayerIds.length;l>s;s++){var h=this.getLayer(i.subLayerIds[s]);i.subLayers.push(h),h.parentLayer=i}}},MapService.prototype.initLegend_=function(e){var t=this.layers;if(e.layers){var r,i,a,o;for(i=0,a=e.layers.length;a>i;i++)o=e.layers[i],r=t[o.layerId],augmentObject_(o,r)}},MapService.prototype.getLayer=function(e){var t=this.layers;if(t)for(var r=0,i=t.length;i>r;r++){if(e===t[r].id)return t[r];if(isString_(e)&&t[r].name.toLowerCase()===e.toLowerCase())return t[r]}return null},MapService.prototype.getLayerDefs_=function(){var e={};if(this.layers)for(var t=0,r=this.layers.length;r>t;t++){var i=this.layers[t];i.definition&&(e[String(i.id)]=i.definition)}return e},MapService.prototype.hasLoaded=function(){return this.loaded_},MapService.prototype.getVisibleLayerIds_=function(){var e=[];if(this.layers){var t,r,i;for(r=0,i=this.layers.length;i>r;r++)if(t=this.layers[r],t.subLayers)for(var a=0,o=t.subLayers.length;o>a;a++)if(t.subLayers[a].visible===!1){t.visible=!1;break}for(r=0,i=this.layers.length;i>r;r++)t=this.layers[r],t.subLayers&&t.subLayers.length>0||t.visible===!0&&e.push(t.id)}return e},MapService.prototype.getInitialBounds=function(){return this.initialExtent?(this.initBounds_=this.initBounds_||fromEnvelopeToLatLngBounds_(this.initialExtent),this.initBounds_):null},MapService.prototype.getFullBounds=function(){return this.fullExtent?(this.fullBounds_=this.fullBounds_||fromEnvelopeToLatLngBounds_(this.fullExtent),this.fullBounds_):null},MapService.prototype.exportMap=function(e,t,r){if(e&&e.bounds){var i={};i.f=e.f;var a=e.bounds,o=a.getSouthWest().lng(),n=a.getNorthEast().lng();o>n&&(o-=180),i.bbox=""+o+","+a.getSouthWest().lat()+","+n+","+a.getNorthEast().lat(),i.size=""+e.width+","+e.height,i.dpi=e.dpi,e.imageSR&&(i.imageSR=e.imageSR.wkid?e.imageSR.wkid:"{wkt:"+e.imageSR.wkt+"}"),i.bboxSR="4326",i.format=e.format;var s=e.layerDefinitions;void 0===s&&(s=this.getLayerDefs_()),i.layerDefs=getLayerDefsString_(s);var l=e.layerIds,h=e.layerOption||"show";if(void 0===l&&(l=this.getVisibleLayerIds_()),l.length>0)i.layers=h+":"+l.join(",");else if(this.loaded_&&t)return void t({href:null});return i.transparent=e.transparent===!1?!1:!0,e.time&&(i.time=formatTimeString_(e.time,e.endTime)),i.layerTimeOptions=e.layerTimeOptions,"image"===i.f?this.url+"/export?"+formatParams_(i):void getJSON_(this.url+"/export",i,"",function(e){e.extent?(e.bounds=fromEnvelopeToLatLngBounds_(e.extent),delete e.extent,t(e)):handleErr_(r,e.error)})}},MapService.prototype.identify=function(e,t,r){if(e){var i={};i.geometry=fromOverlaysToJSON_(e.geometry),i.geometryType=getGeometryType_(e.geometry),i.mapExtent=fromOverlaysToJSON_(e.bounds),i.tolerance=e.tolerance||2,i.sr=4326,i.imageDisplay=""+e.width+","+e.height+","+(e.dpi||96),i.layers=e.layerOption||"all",e.layerIds&&(i.layers+=":"+e.layerIds.join(",")),e.layerDefs&&(i.layerDefs=getLayerDefsString_(e.layerDefs)),i.maxAllowableOffset=e.maxAllowableOffset,i.returnGeometry=e.returnGeometry===!1?!1:!0,getJSON_(this.url+"/identify",i,"",function(i){var a,o,n,s=null;if(i.results)for(s=[],a=0;a<i.results.length;a++)o=i.results[a],n=fromJSONToOverlays_(o.geometry,e.overlayOptions),o.feature={geometry:n,attributes:o.attributes},delete o.attributes;t(i),handleErr_(r,i)})}},MapService.prototype.find=function(e,t,r){if(e){var i=augmentObject_(e,{});e.layerIds&&(i.layers=e.layerIds.join(","),delete i.layerIds),e.searchFields&&(i.searchFields=e.searchFields.join(",")),i.contains=e.contains===!1?!1:!0,e.layerDefinitions&&(i.layerDefs=getLayerDefsString_(e.layerDefinitions),delete i.layerDefinitions),i.sr=4326,i.returnGeometry=e.returnGeometry===!1?!1:!0,getJSON_(this.url+"/find",i,"",function(i){var a,o,n,s=null;if(i.results)for(s=[],a=0;a<i.results.length;a++)o=i.results[a],n=fromJSONToOverlays_(o.geometry,e.overlayOptions),o.feature={geometry:n,attributes:o.attributes},delete o.attributes;t(i),handleErr_(r,i)})}},MapService.prototype.queryLayer=function(e,t,r,i){var a=this.getLayer(e);a&&a.query(t,r,i)},GeocodeService.prototype.init_=function(e){augmentObject_(e,this),e.spatialReference&&(this.spatialReference=spatialReferences_[e.spatialReference.wkid||e.spatialReference.wkt]||WGS84),this.loaded_=!0,triggerEvent_(this,"load")},GeocodeService.prototype.findAddressCandidates=function(e,t,r){var i=augmentObject_(e,{});i.inputs&&(augmentObject_(i.inputs,i),delete i.inputs),isArray_(i.outFields)&&(i.outFields=i.outFields.join(","));var a=this;getJSON_(this.url+"/findAddressCandidates",i,"",function(i){if(i.candidates)for(var o,n,s=[],l=0;l<i.candidates.length;l++)if(o=i.candidates[l],n=o.location,!isNaN(n.x)&&!isNaN(n.y)){var h=[n.x,n.y],p=a.spatialReference;e.outSR&&(p=spatialReferences_[e.outSR]),p&&(h=p.inverse(h)),o.location=new G.LatLng(h[1],h[0]),s[s.length]=o}t({candidates:s}),handleErr_(r,i)})},GeocodeService.prototype.geocode=function(e,t){this.findAddressCandidates(e,t)},GeocodeService.prototype.reverseGeocode=function(e,t,r){isString_(e.location)||(e.location=fromOverlaysToJSON_(e.location)),e.outSR=4326;var i=this;getJSON_(this.url+"/reverseGeocode",e,"",function(e){if(e.location){var a=e.location;if(!isNaN(a.x)&&!isNaN(a.y)){var o=[a.x,a.y];i.spatialReference&&(o=i.spatialReference.inverse(o)),e.location=new G.LatLng(o[1],o[0])}}t(e),handleErr_(r,e)})},GeometryService.prototype.project=function(e,t,r){var i=prepareGeometryParams_(e);getJSON_(this.url+"/project",i,"callback",function(i){var a=[];if(4326===e.outSpatialReference||4326===e.outSpatialReference.wkid){for(var o=0,n=i.geometries.length;n>o;o++)a.push(fromJSONToOverlays_(i.geometries[o]));i.geometries=a}t(i),handleErr_(r,i)})};var SRUnit={METER:9001,FOOT:9002,SURVEY_FOOT:9003,SURVEY_MILE:9035,KILLOMETER:9036,RADIAN:9101,DEGREE:9102};GeometryService.prototype.buffer=function(e,t,r){var i=prepareGeometryParams_(e);e.bufferSpatialReference&&(i.bufferSR=formatSRParam_(e.bufferSpatialReference)),i.outSR=4326,i.distances=e.distances.join(","),e.unit&&(i.unit=e.unit),getJSON_(this.url+"/buffer",i,"callback",function(i){var a=[];if(i.geometries)for(var o=0,n=i.geometries.length;n>o;o++)a.push(fromJSONToOverlays_(i.geometries[o],e.overlayOptions));i.geometries=a,t(i),handleErr_(r,i)})},GPTask.prototype.execute=function(e,t,r){var i={};e.parameters&&augmentObject_(e.parameters,i),i["env:outSR"]=e.outSpatialReference?formatSRParam_(e.outSpatialReference):4326,e.processSpatialReference&&(i["env:processSR"]=formatSRParam_(e.processSpatialReference)),getJSON_(this.url+"/execute",i,"",function(i){if(i.results)for(var a,o,n=0;n<i.results.length;n++)if(a=i.results[n],"GPFeatureRecordSetLayer"===a.dataType)for(var s=0,l=a.value.features.length;l>s;s++)o=a.value.features[s],o.geometry&&(o.geometry=fromJSONToOverlays_(o.geometry,e.overlayOptions));
t(i),handleErr_(r,i)})},RouteTask.prototype.solve=function(e,t,r){if(e){var i=augmentObject_(e,{});isArray_(e.stops)&&(i.stops=fromLatLngsToFeatureSet_(e.stops)),isArray_(e.barriers)&&(e.barriers.length>0?i.barriers=fromLatLngsToFeatureSet_(e.barriers):delete i.barriers),i.returnRoutes=e.returnRoutes===!1?!1:!0,i.returnDirections=e.returnDirections===!0?!0:!1,i.returnBarriers=e.returnBarriers===!0?!0:!1,i.returnStops=e.returnStops===!0?!0:!1,getJSON_(this.url+"/solve",i,"",function(i){i.routes&&parseFeatures_(i.routes.features,e.overlayOptions),t(i),handleErr_(r,i)})}},Projection.prototype.fromLatLngToPoint=function(e,t){if(!e||isNaN(e.lat())||isNaN(e.lng()))return null;var r=this.spatialReference_.forward([e.lng(),e.lat()]),i=t||new G.Point(0,0);return i.x=(r[0]-this.originX_)/this.scale_,i.y=(this.originY_-r[1])/this.scale_,i},Projection.prototype.fromLatLngToPoint=Projection.prototype.fromLatLngToPoint,Projection.prototype.fromPointToLatLng=function(e){if(null===e)return null;var t=e.x*this.scale_+this.originX_,r=this.originY_-e.y*this.scale_,i=this.spatialReference_.inverse([t,r]);return new G.LatLng(i[1],i[0])},Projection.prototype.getScale=function(e){var t=e-this.minZoom,r=0;return this.lods_[t]&&(r=this.lods_[t].scale),r},Projection.WEB_MECATOR=new Projection,TileLayer.prototype.init_=function(e){this.mapService_.tileInfo&&(this.projection_=new Projection(this.mapService_.tileInfo),this.minZoom=e.minZoom||this.projection_.minZoom,this.maxZoom=e.maxZoom||this.projection_.maxZoom)},TileLayer.prototype.getTileUrl=function(e,t){var r=t-(this.projection_?this.projection_.minZoom:this.minZoom),i="";if(!isNaN(e.x)&&!isNaN(e.y)&&r>=0&&e.x>=0&&e.y>=0){var a=this.mapService_.url;this.urlTemplate_&&(a=this.urlTemplate_.replace("["+this.numOfHosts_+"]",""+(e.y+e.x)%this.numOfHosts_));var o=this.projection_||(this.map_?this.map_.getProjection():Projection.WEB_MECATOR);!o instanceof Projection&&(o=Projection.WEB_MECATOR);var n=o.tileSize_,s=1<<t,l=new G.Point(e.x*n.width/s,(e.y+1)*n.height/s),h=new G.Point((e.x+1)*n.width/s,e.y*n.height/s),p=new G.LatLngBounds(o.fromPointToLatLng(l),o.fromPointToLatLng(h)),_=this.mapService_.getFullBounds();if(this.mapService_.singleFusedMapCache===!1||t>this.dynaZoom){var c={f:"image"};c.bounds=p,c.format="png32",c.width=n.width,c.height=n.height,c.imageSR=o.spatialReference_,i=this.mapService_.exportMap(c)}else i=_&&!_.intersects(p)?"":a+"/tile/"+r+"/"+e.y+"/"+e.x}return i},TileLayer.prototype.setOpacity=function(e){this.opacity_=e;var t=this.tiles_;for(var r in t)t.hasOwnProperty(r)&&setNodeOpacity_(t[r],e)},TileLayer.prototype.getOpacity=function(){return this.opacity_},TileLayer.prototype.getMapService=function(){return this.mapService_},MapType.prototype.getTile=function(e,t,r){for(var i=r.createElement("div"),a="_"+e.x+"_"+e.y+"_"+t,o=0;o<this.tileLayers_.length;o++){var n=this.tileLayers_[o];if(t<=n.maxZoom&&t>=n.minZoom){var s=n.getTileUrl(e,t);if(s){var l=r.createElement(document.all?"img":"div");l.style.border="0px none",l.style.margin="0px",l.style.padding="0px",l.style.overflow="hidden",l.style.position="absolute",l.style.top="0px",l.style.left="0px",l.style.width=""+this.tileSize.width+"px",l.style.height=""+this.tileSize.height+"px",document.all?l.src=s:l.style.backgroundImage="url("+s+")",i.appendChild(l),n.tiles_[a]=l,void 0!==n.opacity_?setNodeOpacity_(l,n.opacity_):void 0!==this.opacity_&&setNodeOpacity_(l,this.opacity_)}}}return this.tiles_[a]=i,i.setAttribute("tid",a),i},MapType.prototype.getTile=MapType.prototype.getTile,MapType.prototype.releaseTile=function(e){if(e.getAttribute("tid")){var t=e.getAttribute("tid");this.tiles_[t]&&delete this.tiles_[t];for(var r=0;r<this.tileLayers_.length;r++){var i=this.tileLayers_[r];i.tiles_[t]&&delete i.tiles_[t]}}},MapType.prototype.releaseTile=MapType.prototype.releaseTile,MapType.prototype.setOpacity=function(e){this.opacity_=e;var t=this.tiles_;for(var r in t)if(t.hasOwnProperty(r))for(var i=t[r].childNodes,a=0;a<i.length;a++)setNodeOpacity_(i[a],e)},MapType.prototype.getOpacity=function(){return this.opacity_},MapType.prototype.getTileLayers=function(){return this.tileLayers_},MapOverlay.prototype=new G.OverlayView,MapOverlay.prototype.onAdd=function(){var e=this;this.listeners_.push(G.event.addListener(this.getMap(),"bounds_changed",callback_(this.refresh,this))),this.listeners_.push(G.event.addListener(this.getMap(),"dragstart",function(){e.dragging=!0})),this.listeners_.push(G.event.addListener(this.getMap(),"dragend",function(){e.dragging=!1}));var t=this.getMap();t.agsOverlays=t.agsOverlays||new G.MVCArray,t.agsOverlays.push(this),setCopyrightInfo_(t),this.map_=t},MapOverlay.prototype.onAdd=MapOverlay.prototype.onAdd,MapOverlay.prototype.onRemove=function(){for(var e=0,t=this.listeners_.length;t>e;e++)G.event.removeListener(this.listeners_[e]);this.overlay_&&this.overlay_.setMap(null);var r=this.map_,i=r.agsOverlays;if(i)for(var e=0,a=i.getLength();a>e;e++)if(i.getAt(e)==this){i.removeAt(e);break}setCopyrightInfo_(r),this.map_=null},MapOverlay.prototype.onRemove=MapOverlay.prototype.onRemove,MapOverlay.prototype.draw=function(){this.drawing_&&this.needsNewRefresh_!==!0||this.refresh()},MapOverlay.prototype.draw=MapOverlay.prototype.draw,MapOverlay.prototype.getOpacity=function(){return this.opacity_},MapOverlay.prototype.setOpacity=function(e){var t=Math.min(Math.max(e,0),1);this.opacity_=t,this.overlay_&&setNodeOpacity_(this.overlay_.div_,t)},MapOverlay.prototype.getMapService=function(){return this.mapService_},MapOverlay.prototype.refresh=function(){if(this.drawing_===!0)return void(this.needsNewRefresh_=!0);var e=this.getMap(),t=e?e.getBounds():null;if(t){var r=this.exportOptions_;r.bounds=t;var i=WEB_MERCATOR,a=e.getDiv();if(r.width=a.offsetWidth,r.height=a.offsetHeight,0!=a.offsetWidth&&0!=a.offsetHeight){var o=e.getProjection();o&&o instanceof Projection&&(i=o.spatialReference_),r.imageSR=i,triggerEvent_(this,"drawstart");var n=this;this.drawing_=!0,!this.dragging&&this.overlay_&&(this.overlay_.setMap(null),this.overlay_=null),this.mapService_.exportMap(r,function(e){return n.drawing_=!1,n.needsNewRefresh_===!0?(n.needsNewRefresh_=!1,void n.refresh()):(e.href&&(n.overlay_&&(n.overlay_.setMap(null),n.overlay_=null),n.overlay_=new ImageOverlay(e.bounds,e.href,n.map_,n.opacity_)),void triggerEvent_(n,"drawend"))})}}},MapOverlay.prototype.isHidden=function(){return!(this.visible_&&this.isInZoomRange_())},MapOverlay.prototype.isInZoomRange_=function(){var e=this.getMap().getZoom();return void 0!==this.minZoom&&e<this.minZoom||void 0!==this.maxZoom&&e>this.maxZoom?!1:!0},MapOverlay.prototype.show=function(){this.visible_=!0,this.div_.style.visibility="visible",this.refresh()},MapOverlay.prototype.hide=function(){this.visible_=!1,this.div_.style.visibility="hidden"},ImageOverlay.prototype=new G.OverlayView,ImageOverlay.prototype.onAdd=function(){var e=document.createElement("DIV");e.style.border="none",e.style.borderWidth="0px",e.style.position="absolute";var t=this.map_.getDiv();e.style.width=t.offsetWidth+"px",e.style.height=t.offsetHeight+"px",e.style.backgroundImage="url("+this.url_+")",this.div_=e;var r=this.getPanes();setNodeOpacity_(e,this.op_),r.overlayLayer.appendChild(e)},ImageOverlay.prototype.draw=function(){var e=this.getProjection(),t=e.fromLatLngToDivPixel(this.bounds_.getSouthWest()),r=e.fromLatLngToDivPixel(this.bounds_.getNorthEast()),i=this.div_;i.style.left=t.x+"px",i.style.top=r.y+"px"},ImageOverlay.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_),this.div_=null},CopyrightControl.prototype.refresh=function(){setCopyrightInfo_(this.map_)},gmaps.ags={SpatialReference:SpatialReference,Geographic:Geographic,LambertConformalConic:LambertConformalConic,SphereMercator:SphereMercator,TransverseMercator:TransverseMercator,SpatialRelationship:SpatialRelationship,GeometryType:GeometryType,SRUnit:SRUnit,Catalog:Catalog,MapService:MapService,Layer:Layer,GeocodeService:GeocodeService,GeometryService:GeometryService,GPService:GPService,GPTask:GPTask,RouteTask:RouteTask,Util:Util,Config:Config,Projection:Projection,TileLayer:TileLayer,MapOverlay:MapOverlay,MapType:MapType,CopyrightControl:CopyrightControl},window.gmaps=gmaps}();